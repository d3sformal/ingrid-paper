\documentclass[preprint,10pt,numbers]{sigplanconf}

\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{graphicx}
\usepackage{url}
\usepackage{xspace}
\usepackage{listings}
\usepackage[noline]{algorithm2e}
\usepackage{comment}
\usepackage{color}
\usepackage{times}
\usepackage{multirow}
\usepackage{balance}
\usepackage{framed}
\usepackage{alltt}
\usepackage{textcomp}
\usepackage[dvipsnames]{xcolor}

\setcounter{tocdepth}{3}


% configures style of source code listings
\lstset{
	basicstyle=\small\sffamily
	%basicstyle=\scriptsize\ttfamily
	%numbers=left
}

\lstdefinelanguage{java}{
	morekeywords={abstract,continue,for,new,switch,assert,default,goto,package,synchronized,boolean,stream,event,filter,when,do,if,private,this,break,double,implements,protected,throw,byte,else,import,public,throws,case,enum,instanceof,return,transient,catch,extends,int,short,try,char,final,interface,static,void,class,finally,long,strictfp,volatile,const,float,native,super,while},
	sensitive=false,
	morestring=[b]",
	morestring=[b]',
	morecomment=[l]{//},
	morecomment=[s]{/*}{*/)},
	escapeinside=??,
	moredelim=[is][\textit]{__}{__},
	moredelim=[is][\textbf]{_*}{*_}
}
\lstnewenvironment{displayjava}
	{\lstset{language=java,basicstyle=\small\sffamily,tabsize=2,columns=fullflexible,captionpos=b,xleftmargin=1em,xrightmargin=1em}}{}
\lstnewenvironment{java}
	{\lstset{language=java,basicstyle=\small\sffamily,tabsize=2,columns=fullflexible,captionpos=b}}{}


\newcommand{\code}[1]{{\sf \small #1}\xspace}

\newcommand{\mi}[1]{\mathit{#1}}
\newcommand{\mr}[1]{\mathrm{#1}}
\newcommand{\mt}[1]{\mathtt{#1}}

\newcommand{\todo}[1]{{\bfseries TODO #1}}

% for writing comments
\newcommand{\PP}[1]{\textcolor{blue}{\bfseries PP: #1}} % Pavel Parizek
\newcommand{\PV}[1]{\textcolor{red}{\bfseries PV: #1}} % Premek Vysoky
\newcommand{\JB}[1]{\textcolor{orange}{\bfseries JB: #1}} % JetBrains

% coloring and font style commands
  % ANTLR
\newcommand{\antlrap}{\textquotesingle}
\newcommand{\antlrparserrule}[1]{\textcolor{Blue}{#1}}
\newcommand{\antlrlexerrule}[1]{\textcolor{RedOrange}{#1}}
\newcommand{\antlrliteralnoap}[1]{\textcolor{Maroon}{#1}}
\newcommand{\antlrliteral}[1]{\antlrap\antlrliteralnoap{#1}\antlrap}
\newcommand{\antlrregex}[1]{\textcolor{PineGreen}{#1}}
  % MPS in general
\newcommand{\mpsconcept}[1]{\textcolor{OliveGreen}{#1}}
\newcommand{\mpsinterface}[1]{\textcolor{Plum}{#1}}
  % MPS structure
\newcommand{\mpsstkeyword}[1]{\textcolor{Blue}{\textbf{#1}}}
\newcommand{\mpsstalias}[1]{\textcolor{Green}{\textbf{#1}}}
\newcommand{\mpsstproperty}[1]{\textcolor{Fuchsia}{\textbf{#1}}}
\newcommand{\mpsstplaceholder}[1]{\textcolor{Gray}{\textbf{#1}}}
\newcommand{\mpsstcardinality}[1]{\textcolor{RoyalBlue}{#1}}
  % MPS editor
\newcommand{\mpsedkeyword}[1]{\textcolor{Black}{\textbf{#1}}}
\newcommand{\mpsedtarget}[1]{\textcolor{Fuchsia}{#1}}
\newcommand{\mpsedannotation}[1]{\textcolor{Gray}{\textbf{#1}}}
  % MPS textgen
\newcommand{\mpstgkeyword}[1]{\textcolor{Blue}{\textbf{#1}}}
\newcommand{\mpstgtarget}[1]{\textcolor{Fuchsia}{#1}}
\newcommand{\mpstgparam}[1]{\textcolor{Violet}{#1}}
\newcommand{\mpstgaction}[1]{\textcolor{Fuchsia}{\textbf{#1}}}
\newcommand{\mpstgliteral}[1]{\textcolor{Green}{\textbf{#1}}}
\newcommand{\mpstgnodeprop}[1]{\textcolor{darkgray}{#1}}



\begin{document}


% TODO
%\conferenceinfo{PLDI '17}{June 19--26, 2017, Barcelona, Spain}
%\copyrightyear{20yy}
%\copyrightdata{978-1-nnnn-nnnn-n/yy/mm}
%\copyrightdoi{nnnnnnn.nnnnnnn}

% TODO
%\publicationrights{licensed}


\title{INGRID: Creating Languages in MPS from ANTLR Grammars}


\authorinfo{P\v{r}emysl Vysok\'y \and Pavel Par\'izek}
	{Charles University, Faculty of Mathematics and Physics, Prague, Czech Republic}
	{premek.vysoky@gmail.com, parizek@d3s.mff.cuni.cz}

% TODO upravit affiliation pro JetBrains -> doplnit "s.r.o" nebo radsi "Inc."
% TODO muzeme taky napsat jejich emaily pokud budou lidi z JetBrains souhlasit
\authorinfo{V\'aclav Pech}
	{JetBrains}


\maketitle

\begin{abstract}
JetBrains MPS is a language workbench, an IDE that allows developers both to write code and create or modify language definitions.
It leverages the concept of projectional editing, where the developer directly manipulates the AST representation of program code.
While MPS focuses on domain-specific languages (DSL), it needs to support also general-purpose programming languages (GPLs) --- for example, to compile and run programs written in some DSL, or to enable combination of GPLs with DSLs created in MPS.

We present \textsc{Ingrid}, a new method for construction of a language definition in MPS based on its ANTLR grammar.
The structure of a language is generated automatically, but its other aspects --- including the projectional editor --- must be adjusted manually by the user.
During the development of \textsc{Ingrid}, we encountered several challenges related to the mapping between (i) grammars written in an EBNF-like notation and (ii) the language definitions in MPS based on object-oriented principles.
Another difficulty is that grammars do not hold any information about code layout.

We implemented \textsc{Ingrid} as a plugin for MPS and evaluated it on several full-fledged programming languages, such as JavaScript and C\#.
Results show that our approach is practical.
Even though it is only partially automated, it saves the user from many hours of tedious and error-prone work.
Necessary manual adjustments take only a short time.
\end{abstract}


\category{D.3.2}{Language Classifications}{Extensible languages}
\category{D.3.4}{Processors}{Parsing}
\category{D.3.4}{Processors}{Code generation}
\category{D.2.3}{Coding Tools and Techniques}{Program editors}

\terms
Languages

\keywords
language workbench, projectional editor, grammar, domain-specific language, ANTLR, JetBrains MPS



\input{chapters/introduction}
\input{chapters/background}
\input{chapters/language_definition}
\input{chapters/evaluation}
\input{chapters/conclusion}


\acks
% TODO
This research was supported by JetBrains. \todo{Pridat jeste nejaky grant a kompletne preformulovat.}

\bibliographystyle{abbrvnat}

\begin{thebibliography}{}

\bibitem{ref:BISONFLEX} J. Levine. Flex \& Bison: Text Processing Tools. O'Reilly Media, 2009.

\bibitem{ref:ANTLRBOOK} T. Parr. The Definitive ANTLR 4 Reference. Pragmatic Bookshelf, 2013.

\bibitem{ref:MBEDDR} M. Voelter, D. Ratiu, B. Schaetz, and B. Kolb. mbeddr: an Extensible C-based Programming Language and IDE for Embedded Systems. SPLASH 2012, ACM.

\bibitem{ref:ANTLR} ANTLR parser generator, \url{http://www.antlr.org}

\bibitem{ref:ANTLR2MPS} F. Campagne. The ANTRL{\_}MPS project, \url{https://github.com/CampagneLaboratory/ANTLR_MPS}

\bibitem{ref:MPSMETABNF} DSLFoundry. The mps-metabnf project, \url{https://github.com/DSLFoundry/mps-metabnf}

\bibitem{ref:ECMASCRIPT51} ECMAScript Language Specification, Edition 5.1 (June 2011), \url{http://www.ecma-international.org/ecma-262/5.1/Ecma-262.pdf}

\bibitem{ref:MPS} JetBrains MPS, \url{https://www.jetbrains.com/mps/}

\bibitem{ref:JSON} The JSON Data Interchange Format, 1st Edition (October 2013), \url{http://www.ecma-international.org/publications/files/ECMA-ST/ECMA-404.pdf}

\bibitem{ref:ECMA4MPS} M. Lombardo. The ECMAScript4MPS project, \url{https://github.com/mar9000/ecmascript4mps}

\bibitem{ref:PE4MPS} M. Lombardo. The PE4MPS project, \url{https://github.com/mar9000/pe4mps}

\bibitem{ref:PE} M. Lombardo. PE grammars, \url{https://github.com/mar9000/pe}

\bibitem{ref:BASELANG} MPS BaseLanguage, \url{https://confluence.jetbrains.com/display/MPSD34/Base+Language}

\end{thebibliography}

\end{document}

