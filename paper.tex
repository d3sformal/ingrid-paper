\documentclass[sigplan,10pt,preprint]{acmart}

\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{graphicx}
\usepackage{url}
\usepackage{xspace}
\usepackage{listings}
\usepackage[noline]{algorithm2e}
\usepackage{comment}
\usepackage{color}
\usepackage{multirow}
\usepackage{balance}
\usepackage{framed}
\usepackage{alltt}
\usepackage{xcolor}

\setcounter{tocdepth}{3}

\settopmatter{printfolios=true}


% configures style of source code listings
\lstset{
	basicstyle=\small\sffamily
	%basicstyle=\scriptsize\ttfamily
	%numbers=left
}

\lstdefinelanguage{java}{
	morekeywords={abstract,continue,for,new,switch,assert,default,goto,package,synchronized,boolean,stream,event,filter,when,do,if,private,this,break,double,implements,protected,throw,byte,else,import,public,throws,case,enum,instanceof,return,transient,catch,extends,int,short,try,char,final,interface,static,void,class,finally,long,strictfp,volatile,const,float,native,super,while},
	sensitive=false,
	morestring=[b]",
	morestring=[b]',
	morecomment=[l]{//},
	morecomment=[s]{/*}{*/)},
	escapeinside=??,
	moredelim=[is][\textit]{__}{__},
	moredelim=[is][\textbf]{_*}{*_}
}
\lstnewenvironment{displayjava}
	{\lstset{language=java,basicstyle=\small\sffamily,tabsize=2,columns=fullflexible,captionpos=b,xleftmargin=1em,xrightmargin=1em}}{}
\lstnewenvironment{java}
	{\lstset{language=java,basicstyle=\small\sffamily,tabsize=2,columns=fullflexible,captionpos=b}}{}


\newcommand{\code}[1]{{\sf \small #1}\xspace}

\newcommand{\mi}[1]{\mathit{#1}}
\newcommand{\mr}[1]{\mathrm{#1}}
\newcommand{\mt}[1]{\mathtt{#1}}

\newcommand{\todo}[1]{{\bfseries TODO #1}}

% for writing comments
\newcommand{\PP}[1]{\textcolor{blue}{\bfseries PP: #1}} % Pavel Parizek
\newcommand{\PV}[1]{\textcolor{red}{\bfseries PV: #1}} % Premek Vysoky
\newcommand{\JB}[1]{\textcolor{orange}{\bfseries JB: #1}} % JetBrains

% coloring and font style commands
  % ANTLR
\newcommand{\antlrap}{\textquotesingle}
\newcommand{\antlrparserrule}[1]{\textcolor{blue}{#1}}
\newcommand{\antlrlexerrule}[1]{\textcolor{red}{#1}}
\newcommand{\antlrliteralnoap}[1]{\textcolor{brown}{#1}}
\newcommand{\antlrliteral}[1]{\antlrap\antlrliteralnoap{#1}\antlrap}
\newcommand{\antlrregex}[1]{\textcolor{olive}{#1}}
  % MPS in general
\newcommand{\mpsconcept}[1]{\textcolor{olive}{#1}}
\newcommand{\mpsinterface}[1]{\textcolor{violet}{#1}}
  % MPS structure
\newcommand{\mpsstkeyword}[1]{\textcolor{blue}{\textbf{#1}}}
\newcommand{\mpsstalias}[1]{\textcolor{olive}{\textbf{#1}}}
\newcommand{\mpsstproperty}[1]{\textcolor{violet}{\textbf{#1}}}
\newcommand{\mpsstplaceholder}[1]{\textcolor{gray}{\textbf{#1}}}
\newcommand{\mpsstcardinality}[1]{\textcolor{cyan}{\textbf{#1}}}
  % MPS editor
\newcommand{\mpsedkeyword}[1]{\textcolor{black}{\textbf{#1}}}
\newcommand{\mpsedtarget}[1]{\textcolor{magenta}{\textbf{#1}}}
\newcommand{\mpsedannotation}[1]{\textcolor{gray}{\textbf{#1}}}
  % MPS textgen
\newcommand{\mpstgkeyword}[1]{\textcolor{blue}{\textbf{#1}}}
\newcommand{\mpstgtarget}[1]{\textcolor{magenta}{\textbf{#1}}}
\newcommand{\mpstgparam}[1]{\textcolor{violet}{\textbf{#1}}}
\newcommand{\mpstgaction}[1]{\textcolor{violet}{\textbf{#1}}}
\newcommand{\mpstgliteral}[1]{\textcolor{olive}{\textbf{#1}}}
\newcommand{\mpstgnodeprop}[1]{\textcolor{darkgray}{\textbf{#1}}}



% TODO
%\acmConference[PL'17]{ACM SIGPLAN Conference on Programming Languages}{January 01--03, 2017}{New York, NY, USA}
%\acmYear{2017}
%\acmISBN{978-x-xxxx-xxxx-x/YY/MM}
%\acmDOI{10.1145/nnnnnnn.nnnnnnn} 


% TODO
%\setcopyright{acmlicensed} 



\begin{document}


\title{INGRID: Creating Languages in MPS from ANTLR Grammars}


\author{P\v{r}emysl Vysok\'y}
\affiliation{
  \institution{Charles University, Faculty of Mathematics and Physics}
  \city{Prague}
  \country{Czech Republic}
}
\email{premek.vysoky@gmail.com}

\author{Pavel Par\'izek}
\affiliation{
  \institution{Charles University, Faculty of Mathematics and Physics}
  \city{Prague}
  \country{Czech Republic}
}
\email{parizek@d3s.mff.cuni.cz}

\author{V\'aclav Pech}
\affiliation{
  \institution{JetBrains}
}
\email{vaclav@jetbrains.com}



\begin{abstract}
JetBrains MPS is a language workbench, an IDE that allows developers both to write code and create language definitions.
It leverages the concept of projectional editing, where the developer directly manipulates the AST representation of program code.
While MPS focuses on domain-specific languages (DSL), it needs to support also general-purpose programming languages (GPPLs) --- for example, to compile and run programs written in some DSL.
%, or to enable combination of GPPLs with DSLs created in MPS.

We present \textsc{Ingrid}, a method for construction of a language definition in MPS based on its ANTLR grammar.
The structure of a language is generated automatically, but its projectional editor and other aspects has to be adjusted manually.
%by the user.
During the development of \textsc{Ingrid}, we encountered several challenges related to the mapping between grammars and language definitions in MPS that are based on object-oriented principles.
Another difficulty is that grammars do not hold any information about code layout.

We implemented \textsc{Ingrid} as a plugin for MPS and evaluated it on several mainstream GPPLs, such as JavaScript and C\#.
Results show that our approach is practical, and it saves the user from many hours of tedious and error-prone work.
Necessary manual adjustments take only a short time.
\end{abstract}


 \begin{CCSXML}
<ccs2012>
<concept>
<concept_id>10011007.10011006.10011008.10011009.10011019</concept_id>
<concept_desc>Software and its engineering~Extensible languages</concept_desc>
<concept_significance>500</concept_significance>
</concept>
<concept>
<concept_id>10011007.10011006.10011041.10011047</concept_id>
<concept_desc>Software and its engineering~Source code generation</concept_desc>
<concept_significance>500</concept_significance>
</concept>
<concept>
<concept_id>10011007.10011006.10011041.10011688</concept_id>
<concept_desc>Software and its engineering~Parsers</concept_desc>
<concept_significance>500</concept_significance>
</concept>
<concept>
<concept_id>10011007.10011006.10011066.10011069</concept_id>
<concept_desc>Software and its engineering~Integrated and visual development environments</concept_desc>
<concept_significance>500</concept_significance>
</concept>
</ccs2012>
\end{CCSXML}

\ccsdesc[500]{Software and its engineering~Extensible languages}
\ccsdesc[500]{Software and its engineering~Source code generation}
\ccsdesc[500]{Software and its engineering~Parsers}
\ccsdesc[500]{Software and its engineering~Integrated and visual development environments}

\keywords{language workbench, projectional editor, grammar, domain-specific language, ANTLR, JetBrains MPS}

\maketitle



\input{chapters/introduction}
\input{chapters/background}
\input{chapters/language_definition}
\input{chapters/evaluation}
\input{chapters/conclusion}


\begin{acks}
% TODO mozna pridat jeste nejaky dalsi grant (az clanek nekam vezmou)
This work was partially supported by JetBrains.
\end{acks}


\bibliographystyle{abbrvnat}

\begin{thebibliography}{}

\bibitem{ref:MPSBOOK} F. Campagne. The MPS Language Workbench, Volume I. CreateSpace Independent Publishing Platform, 2014.

\bibitem{ref:DHL80} V. Donzeau-Gouge, G. Huet, B. Lang, and G. Kahn. Programming Environments Based on Structured Editors: The Mentor Experience. Research Report RR-0026, INRIA, 1980.

\bibitem{ref:BISONFLEX} J. Levine. Flex \& Bison: Text Processing Tools. O'Reilly Media, 2009.

\bibitem{ref:KV10} L.C.L. Kats and E. Visser. The Spoofax Language Workbench: Rules for Declarative Specification of Languages and IDEs. OOPSLA 2010, ACM.

\bibitem{ref:ANTLRBOOK} T. Parr. The Definitive ANTLR 4 Reference. Pragmatic Bookshelf, 2013.

\bibitem{ref:MBEDDR} M. Voelter, D. Ratiu, B. Schaetz, and B. Kolb. mbeddr: an Extensible C-based Programming Language and IDE for Embedded Systems. SPLASH 2012, ACM.

\bibitem{ref:VSB14} M. Voelter, J. Siegmund, T. Berger, and B. Kolb. Towards User-Friendly Projectional Editors. SLE 2014, LNCS, 8706.

\bibitem{ref:VWK15} M. Voelter, J. Warmer, and B. Kolb. Projecting a Modular Future. IEEE Software, 32(5), 2015.

\bibitem{ref:CSHARP} C\# Language Specification, Version 5.0 (2012), Microsoft Corporation, \url{https://msdn.microsoft.com/en-us/library/ms228593.aspx}

\bibitem{ref:ECMASCRIPT51} ECMAScript Language Specification, Edition 5.1 (June 2011), \url{http://www.ecma-international.org/ecma-262/5.1/Ecma-262.pdf}

\bibitem{ref:JSON} The JSON Data Interchange Format, 1st Edition (October 2013), \url{http://www.ecma-international.org/publications/files/ECMA-ST/ECMA-404.pdf}

\bibitem{ref:MPS} JetBrains MPS, \url{https://www.jetbrains.com/mps/}

\bibitem{ref:ANTLR} ANTLR parser generator, \url{http://www.antlr.org}

\bibitem{ref:ANTLR2MPS} F. Campagne. The ANTRL{\_}MPS project, \url{https://github.com/CampagneLaboratory/ANTLR_MPS}

\bibitem{ref:MPSMETABNF} DSLFoundry. The mps-metabnf project, \url{https://github.com/DSLFoundry/mps-metabnf}

\bibitem{ref:ECMA4MPS} M. Lombardo. The ECMAScript4MPS project, \url{https://github.com/mar9000/ecmascript4mps}

\bibitem{ref:PE4MPS} M. Lombardo. The PE4MPS project, \url{https://github.com/mar9000/pe4mps}

\bibitem{ref:PE} M. Lombardo. PE grammars, \url{https://github.com/mar9000/pe}

\bibitem{ref:BASELANG} MPS BaseLanguage, \url{https://confluence.jetbrains.com/display/MPSD34/Base+Language}

\end{thebibliography}

\end{document}

